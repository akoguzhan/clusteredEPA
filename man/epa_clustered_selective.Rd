% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/test_functions.R
\name{epa_clustered_selective}
\alias{epa_clustered_selective}
\title{Selective Inference for Clustered EPA}
\usage{
epa_clustered_selective(
  Z,
  id,
  time,
  OmegaHat,
  estimated_k_means,
  pairs = NULL,
  pcombine_fun = "pharmonic",
  method = "H1",
  order_k = NULL,
  r = NULL,
  epi = NULL,
  lrv = "EWC",
  lrv_par = NULL
)
}
\arguments{
\item{Z}{NT x P matrix of loss differentials or moments.}

\item{id}{Vector of unit identifiers (length NT).}

\item{time}{Vector of time identifiers (length NT).}

\item{OmegaHat}{Long-run variance matrix (GK x GK).}

\item{estimated_k_means}{Output from panel_kmeans_estimation().}

\item{pairs}{Optional matrix of cluster index pairs to test (each row: c(k1, k2)). If NULL, all unique pairs are tested.}

\item{pcombine_fun}{Function to combine p-values: "pmean", "porder", "pSimes", "pharmonic", "pCauchy".}

\item{method}{Variant used by pmerge (e.g., "H1", "I", "G", etc.).}

\item{order_k}{Used by porder.}

\item{r}{Used by pmean.}

\item{epi}{Used by pCauchy.}

\item{lrv}{Character; "EWC" or "NeweyWest" for overall_EPA_test.}

\item{lrv_par}{Integer; lag (NW) or B (EWC) for overall_EPA_test.}
}
\value{
List with all pairwise p-values, overall p-value, and selective p-value.
}
\description{
Performs selective inference for clustered Equal Predictive Ability (EPA):
1. Runs panel_homogeneity_test to get all pairwise cluster p-values (with flexible combination).
2. Runs overall_EPA_test for the global null.
3. Combines all [K(K-1)/2 + 1] p-values using the specified method (default: pharmonic).
}
